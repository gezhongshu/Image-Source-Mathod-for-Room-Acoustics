% Load the measured source and its sample rate
load ('~/Desktop/reverberation/room-measures/source.mat')
% Load the measured IR
addr1a = '~/Desktop/reverberation/room-measures/pollack/pollack1a.mat';
addr1b = '~/Desktop/reverberation/room-measures/pollack/pollack1b.mat';
addr2a = '~/Desktop/reverberation/room-measures/pollack/pollack2a.mat';
addr2b = '~/Desktop/reverberation/room-measures/pollack/pollack2b.mat';
addr3a = '~/Desktop/reverberation/room-measures/pollack/pollack3a.mat';
addr3b = '~/Desktop/reverberation/room-measures/pollack/pollack3b.mat';

% Space volume
% V = 7.8683e+03-226.8000-72.9-17.496-28.1880-323.5680-246.8880;
V = 6.9525e+03;

% Different source and receiver positions in the model
src =[9  28.38  2.68; ...
    9  28.38  2.68; ...
    9  28.38  2.68; ...
    ];
rcv = [
    9    16.83  2.54; ...
    7.93, 20.42, 1.94; ...
    13.67, 20.39, 1.93; ...
    ];
ref_direc = [
    0   -1   0; ...
    ];

% Wall absorption coefficients at different frequency bands
f = [125 250 500 1000 2000 4000 8000];
Stairs = [0.05 0.05 0.2 0.3 0.4 0.45 0.45];
Acoustical_plaster = [0.17 0.36 0.66 0.65 0.62 0.68 0.68];
carpet = [0.1 0.4 0.62 0.70 0.63 0.88 0.88];
StageWood = [0.1 0.07 0.06 0.06 0.06 0.06 0.06];
% Trapezoidal = [0.13 0.56 0.95 0.95 0.95 0.95 0.95];
steel_frame = [0.15 0.1 0.06 0.04 0.04 0.05 0.05];
plaster = [0.02 0.02 0.03 0.03 0.04 0.05 0.05];
Gypsum_board = [0.3 0.69 1 0.81 0.66 0.62 0.62];
chairs = [0.49 0.66 0.8 0.88 0.82 0.70 0.70];

% f_Stairs = Wall_Filter(f, Stairs, fs, DispFilter);
% f_Acoustical_plaster = Wall_Filter(f, Acoustical_plaster, fs,  DispFilter);
% f_carpet = Wall_Filter(f, carpet, fs, DispFilter);
% f_StageWood = Wall_Filter(f, StageWood, fs, DispFilter);
% % f_Trapezoidal = Wall_Filter(f, Trapezoidal, fs, DispFilter);
% f_steel_frame = Wall_Filter(f, steel_frame, fs, DispFilter);
% f_plaster = Wall_Filter(f, plaster, fs, DispFilter);
% f_Gypsum_board = Wall_Filter(f, Gypsum_board, fs,  DispFilter);

f_Stairs = sqrt(1-Stairs(Band_num));
f_Acoustical_plaster = sqrt(1-Acoustical_plaster(Band_num));
f_chairs = sqrt(1-chairs(Band_num));
f_carpet = sqrt(1-carpet(Band_num));
f_StageWood = sqrt(1-StageWood(Band_num));
f_steel_frame = sqrt(1-steel_frame(Band_num));
f_plaster = sqrt(1-plaster(Band_num));
f_Gypsum_board = sqrt(1-Gypsum_board(Band_num));

beta = [f_Stairs;...               % 1
    f_Acoustical_plaster;...     % 2
    f_Acoustical_plaster;...     % 3
    f_carpet;...     % 4
    f_StageWood;...     % 5
    f_Acoustical_plaster;...     % 6
    f_Acoustical_plaster;...     % 7
    f_Acoustical_plaster;...     % 8
    f_StageWood;...     % 9
    f_steel_frame;...     % 10
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       % 15
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       % 20
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       25
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       30
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       35
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       40
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       45
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       50
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       55
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       60
    f_plaster;...
    f_Gypsum_board;...
    f_chairs;...
    f_Gypsum_board;...
    f_chairs;...       65
    f_Gypsum_board;...
    f_chairs;...
    f_Gypsum_board;...
    f_chairs;...
    f_Gypsum_board;...       70
    f_chairs;...
    f_Gypsum_board;...
    f_chairs;...
    f_Gypsum_board;...
    f_chairs;...       75
    f_Gypsum_board;...
    f_chairs;...
    f_Gypsum_board;...
    f_chairs;...
    f_Gypsum_board;...       80
    f_chairs;...
    f_Gypsum_board;...
    f_chairs;...
    f_Gypsum_board;...
    f_chairs;...       85
    f_Gypsum_board;...
    f_chairs;...
    f_Gypsum_board;...
    f_chairs;...
    f_Gypsum_board;...       90
    f_chairs;...
    f_Gypsum_board;...
    f_chairs;...
    f_Gypsum_board;...
    f_chairs;...       95
    f_Gypsum_board;...
    f_chairs;...
    f_Gypsum_board;...
    f_chairs;...
    f_Gypsum_board;...       100
    f_chairs;...
    f_Gypsum_board;...
    f_chairs;...
    f_Gypsum_board;...
    f_chairs;...       105
    f_Gypsum_board;...
    f_chairs;...
    f_Gypsum_board;...
    f_chairs;...
    f_Gypsum_board;...       110
    f_chairs;...
    f_Gypsum_board;...
    f_chairs;...
    f_plaster;...
    f_plaster;...       115
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       120
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       125
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       130
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       135
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       140
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       145
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       150
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       155
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       160
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       165
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       170
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       175
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       180
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       185
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       190
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       195
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       200
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       205
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       210
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       215
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       220
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       225
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       230
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       235
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...       240
    f_plaster;...
    f_plaster;...
    f_plaster;...
    f_plaster;...
    ];

wall = [11 13 14 12 0  0; ... % 1
    1  9  13 11 0  0; ... % 2
    12 14 10 4  0  0; ... % 3
    13 9  10 14 0  0; ... % 4
    5  8  10 9  0  0; ... % 5
    1  2  6  5  0  0; ... % 6
    2  3  7  6  0  0; ... % 7
    3  4  8  7  0  0; ... % 8
    5  6  7  8  0  0; ... % 9
    1  11 12 4  3  2; ...    % 10
    % column 1
    16 15 19 20 0  0; ...    % 11
    17 16 20 21 0  0; ...    % 12
    18 17 21 22 0  0; ...    % 13
    % column 2
    24 23 27 28 0  0; ...    % 14
    25 24 28 29 0  0; ...    % 15
    26 25 29 30 0  0; ...    % 16
    % column 3
    32 31 35 36 0  0; ...   % 17
    33 32 36 37 0  0; ...   % 18
    34 33 37 38 0  0; ...   % 19
    % column 4
    40 39 43 44 0  0; ...   % 20
    41 40 44 45 0  0; ...
    42 41 45 46 0  0; ...
    % column 5
    48 47 51 52 0  0; ...
    49 48 52 53 0  0; ...
    50 49 53 54 0  0; ...   % 25
    % column 1 right
    55 56 60 59 0  0; ...
    56 57 61 60 0  0; ...
    57 58 62 61 0  0; ...
    % column 2 right
    63 64 68 67 0  0; ...
    64 65 69 68 0  0; ...   % 30
    65 66 70 69 0  0; ...
    % column 3 right
    71 72 76 75 0  0; ...
    72 73 77 76 0  0; ...
    73 74 78 77 0  0; ...
    % column 4 right
    79 80 84 83 0  0; ...   % 35
    80 81 85 84 0  0; ...
    81 82 86 85 0  0; ...
    % column 5 right
    87 88 92 91 0  0; ...
    88 89 93 92 0  0; ...
    89 90 94 93 0  0; ...   % 40
    % column
    99   100  96  95 0 0; ...
    100  101  97  96 0 0; ...
    101  102  98  97 0 0; ...
    % column
    107   108  104  103 0 0; ...
    108  109  105  104 0 0; ...     % 45
    109  110  106  105 0 0; ...
    % column slanted left 1
    115  116  112  111  0  0; ...
    116  117  113  112  0  0; ...
    117  118  114  113  0  0; ...
    % column slanted left 2
    123  124  120  119  0  0; ...   % 50
    124  125  121  120  0  0; ...
    125  126  122  121  0  0; ...
    % column slanted left 3
    131  132  128  127  0  0; ...
    132  133  129  128  0  0; ...
    133  134  130  129  0  0; ...   % 55
    % column slanted right 1
    135  136  140  139  0  0; ...
    136  137  141  140  0  0; ...
    137  138  142  141  0  0; ...
    % column slanted right 2
    143  144  148  147  0  0; ...
    144  145  149  148  0  0; ...   % 60
    145  146  150  149  0  0; ...
    % column slanted right 3
    151  152  156  155  0  0; ...
    152  153  157  156  0  0; ...   % 60
    153  154  158  157  0  0; ...
    % stairs
    159  160  162  161  0  0; ...
    161  162  164  163  0  0; ...
    163  164  166  165  0  0; ...
    165  166  168  167  0  0; ... 
    167  168  170  169  0  0; ...
    169  170  172  171  0  0; ...
    171  172  174  173  0  0; ...
    173  174  176  175  0  0; ...
    175  176  178  177  0  0; ...  
    177  178  180  179  0  0; ...
    179  180  182  181  0  0; ...
    181  182  184  183  0  0; ...
    183  184  186  185  0  0; ...
    185  186  188  187  0  0; ... 
    187  188  190  189  0  0; ...
    189  190  192  191  0  0; ...
    191  192  194  193  0  0; ...
    193  194  196  195  0  0; ...
    195  196  198  197  0  0; ... 
    197  198  200  199  0  0; ...
    199  200  202  201  0  0; ...
    201  202  204  203  0  0; ...
    203  204  206  205  0  0; ...
    205  206  208  207  0  0; ...
    207  208  210  209  0  0; ...
    209  210  212  211  0  0; ...
    211  212  214  213  0  0; ...
    213  214  216  215  0  0; ...
    215  216  218  217  0  0; ... 
    217  218  220  219  0  0; ...
    219  220  222  221  0  0; ...
    221  222  224  223  0  0; ...
    223  224  226  225  0  0; ...
    225  226  228  227  0  0; ... 
    227  228  230  229  0  0; ...
    229  230  232  231  0  0; ...
    231  232  234  233  0  0; ...
    233  234  236  235  0  0; ...
    235  236  238  237  0  0; ...
    237  238  240  239  0  0; ...
    239  240  242  241  0  0; ...
    241  242  244  243  0  0; ...
    243  244  246  245  0  0; ...
    245  246  248  247  0  0; ...
    247  248  250  249  0  0; ...
    249  250  252  251  0  0; ...
    251  252  254  253  0  0; ...
    253  254  256  255  0  0; ...
    255  256  258  257  0  0; ...
    257  258  260  259  0  0; ...
    259  260  262  261  0  0; ...
    261  262  264  263  0  0; ...
    % Heng liang lower left 1
    265  266  267  0    0  0; ...   % 117
    266  269  270  267  0  0; ...
    265  267  270  268  0  0; ...
    268  270  269  0    0  0; ...   % 120
    % Heng liang lower left 2
    271  272  273  0    0  0; ...
    272  275  276  273  0  0; ...
    271  273  276  274  0  0; ...
    274  276  275  0    0  0; ...
    % Heng liang lower right 1
    277  279  278  0    0  0; ...   % 125
    282  280  281  0    0  0; ...
    279  282  281  278  0  0; ...
    277  280  282  279  0  0; ...
    % Heng liang lower right 2
    283  285  284  0    0  0; ...
    288  286  287  0    0  0; ...   %130
    285  288  287  284  0  0; ...
    283  286  288  285  0  0; ...
    % Hengliang slanted left 1
    289  290  291  0    0  0; ...   
    290  293  294  291  0  0; ...
    289  291  294  292  0  0; ...   % 135
    292  294  293  0    0  0; ...
    % Hengliang slanted left 2
    295  296  297  0    0  0; ...
    296  299  300  297  0  0; ...  
    295  297  300  298  0  0; ...
    298  300  299  0    0  0; ...   % 140
    % Hengliang slanted right 1
    303  302  301  0    0  0; ...
    304  305  306  0    0  0; ...
    303  306  305  302  0  0; ... 
    301  304  306  303  0  0; ...
    % Hengliang slanted right 2
    309  308  307  0    0  0; ...   % 145
    310  311  312  0    0  0; ...
    309  312  311  308  0  0; ...
    307  310  312  309  0  0; ... 
    % Hengliang top 1
    313  314  315  0    0  0; ...
    314  317  318  315  0  0; ...   % 150
    313  315  318  316  0  0; ...
    316  318  317  0    0  0; ...
    % Hengliang top 2
    319  320  321  0    0  0; ... 
    320  323  324  321  0  0; ...
    319  321  324  322  0  0; ...   155
    322  324  323  0    0  0; ...
    % Hengliang top 3
    325  326  327  0    0  0; ...
    326  329  330  327  0  0; ...
    325  327  330  328  0  0; ...
    328  330  329  0    0  0; ...   160
    % Hengliang higher left 1
    331  332  333  0    0  0; ...
    332  335  336  333  0  0; ...
    331  333  336  334  0  0; ... 
    334  336  335  0    0  0; ...
    % Hengliang higher left 2
    337  338  339  0    0  0; ...   165
    338  341  342  339  0  0; ...
    337  339  342  340  0  0; ...
    340  342  341  0    0  0; ...   
    % Hengliang higher left 3
    343  344  345  0    0  0; ...
    344  347  348  345  0  0; ...   170
    343  345  348  346  0  0; ...
    346  348  347  0    0  0; ...
    % Hengliang higher left 4
    349  350  351  0    0  0; ...   
    350  353  354  351  0  0; ...
    349  351  354  352  0  0; ...   175
    352  354  353  0    0  0; ...
    % Hengliang higher right 1
    355  357  356  0    0  0; ...
    360  358  359  0    0  0; ...   
    357  360  359  356  0  0; ...
    355  358  360  357  0  0; ...   180
    % Hengliang higher right 2
    361  363  362  0    0  0; ...
    366  364  365  0    0  0; ...
    363  366  365  362  0  0; ... 
    361  364  366  363  0  0; ...
    % Hengliang higher right 3
    367  369  368  0    0  0; ...   185
    372  370  371  0    0  0; ...
    369  372  371  368  0  0; ...
    367  370  372  369  0  0; ... 
    % Hengliang higher right 4
    373  375  374  0    0  0; ...
    378  376  377  0    0  0; ...   190
    375  378  377  374  0  0; ...
    373  376  378  375  0  0; ...
    % Hengliang slanted higher left 1
    379  380  381  0    0  0; ... 
    380  383  384  381  0  0; ...
    379  381  384  382  0  0; ...   195
    382  384  383  0    0  0; ...
    % Hengliang slanted higher left 2
    385  386  387  0    0  0; ...
    386  389  390  387  0  0; ...  
    385  387  390  388  0  0; ...
    388  390  389  0    0  0; ...   200
    % Hengliang slanted higher right 1
    393  392  391  0    0  0; ...
    394  395  396  0    0  0; ...
    393  396  395  392  0  0; ... 
    391  394  396  393  0  0; ...
    % Hengliang slanted higher right 2
    399  398  397  0    0  0; ...   205
    400  401  402  0    0  0; ...
    399  402  401  398  0  0; ...
    397  400  402  399  0  0; ... 
    % Hengliang higher top 1
    403  404  405  0    0  0; ...
    404  407  408  405  0  0; ...   210
    403  405  408  406  0  0; ...
    406  408  407  0    0  0; ...
    % Hengliang higher top 2
    409  410  411  0    0  0; ...
    410  413  414  411  0  0; ...
    409  411  414  412  0  0; ...   215
    412  414  413  0    0  0; ...
    % Hengliang higher top 3
    415  416  417  0    0  0; ...
    416  419  420  417  0  0; ... 
    415  417  420  418  0  0; ...
    418  420  419  0    0  0; ...   220
    % little Hengliang left 1
    421  425  426  422  0  0; ...
    422  426  427  423  0  0; ...
    423  427  428  424  0  0; ... 
    % little Hengliang left 2
    429  433  434  430  0  0; ...
    430  434  435  431  0  0; ...   225
    431  435  436  432  0  0; ...
    % little Hengliang left 3
    437  441  442  438  0  0; ...
    438  442  443  439  0  0; ... 
    439  443  444  440  0  0; ...
    % little Hengliang left 4
    445  449  450  446  0  0; ...   230
    446  450  451  447  0  0; ...
    447  451  452  448  0  0; ...
    % little Hengliang right 1
    454  458  457  453  0  0; ...  
    455  459  458  454  0  0; ...
    456  460  459  455  0  0; ...   235
    % little Hengliang right 2
    462  466  465  461  0  0; ...
    463  467  466  462  0  0; ...
    464  468  467  463  0  0; ...
    % little Hengliang right 3
    470  474  473  469  0  0; ...
    471  475  474  470  0  0; ...   240
    472  476  475  471  0  0; ...
    % little Hengliang right 4
    478  482  481  477  0  0; ...
    479  483  482  478  0  0; ... 
    480  484  483  479  0  0; ...
    ];

vertex = [0    26  12.65; ...             % 1
    2.6  36  12.65; ...             % 2
    15.4 36  12.65; ...             % 3
    18   26  12.65; ...             % 4
    0    26  1.143; ...             % 5
    2.6  36  1.143; ...             % 6
    15.4 36  1.143; ...             % 7
    18   26  1.143; ...             % 8
    0    26  0; ...                 % 9
    18   26  0; ...                 % 10
    0    0   12.65; ...             % 11
    18   0   12.65; ...             % 12
    0    0   0; ...                 % 13
    18   0   0; ...                 % 14
    % column 1
    0    3.6+0.2 0; ...                 % 15
    0.4  3.6+0.2 0; ...                 % 16
    0.4  4.4+0.2 0; ...                 % 17
    0    4.4+0.2 0; ...                 % 18
    0    3.6+0.2 12.65; ...             % 19
    0.4  3.6+0.2 12.65; ...             % 20
    0.4  4.4+0.2 12.65; ...             % 21
    0    4.4+0.2 12.65; ...             % 22
    % column 2
    0    8+0.2+0.2   0; ...                 % 23
    0.4  8+0.2+0.2   0; ...                 % 24
    0.4  8.8+0.2+0.2 0; ...                 % 25
    0    8.8+0.2+0.2 0; ...                 % 26
    0    8+0.2+0.2   12.65; ...             % 27
    0.4  8+0.2+0.2   12.65; ...             % 28
    0.4  8.8+0.2+0.2 12.65; ...             % 29
    0    8.8+0.2+0.2 12.65; ...             % 30
    % column 3
    0    12.4 0; ...                % 31
    0.4  12.4 0; ...                % 32
    0.4  13.2 0; ...                % 33
    0    13.2 0; ...                % 34
    0    12.4 12.65; ...            % 35
    0.4  12.4 12.65; ...            % 36
    0.4  13.2 12.65; ...            % 37
    0    13.2 12.65; ...            % 38
    % column 4
    0    16.8 0; ...              % 39
    0.4  16.8 0; ...              % 40
    0.4  17.6 0; ...              % 41
    0    17.6 0; ...              % 42
    0    16.8 12.65; ...          % 43
    0.4  16.8 12.65; ...          % 44
    0.4  17.6 12.65; ...          % 45
    0    17.6 12.65; ...          % 46
    % column 5
    0    21.2 0; ...              % 47
    0.4  21.2 0; ...              % 48
    0.4  22   0; ...              % 49
    0    22   0; ...              % 50
    0    21.2 12.65; ...          % 51
    0.4  21.2 12.65; ...          % 52
    0.4  22   12.65; ...          % 53
    0    22   12.65; ...          % 54
    % column 1 right
    18    3.6  0; ...             % 55
    17.6  3.6  0; ...             % 56
    17.6  4.4  0; ...             % 57
    18    4.4  0; ...             % 58
    18    3.6  12.65; ...         % 59
    17.6  3.6  12.65; ...         % 60
    17.6  4.4  12.65; ...         % 61
    18    4.4  12.65; ...         % 62
    % column 2 right
    18    8   0; ...                 % 63
    17.6  8   0; ...                 % 64
    17.6  8.8 0; ...                 % 65
    18    8.8 0; ...                 % 66
    18    8   12.65; ...             % 67
    17.6  8   12.65; ...             % 68
    17.6  8.8 12.65; ...             % 69
    18    8.8 12.65; ...             % 70
    % column 3 right
    18    12.4 0; ...                % 71
    17.6  12.4 0; ...                % 72
    17.6  13.2 0; ...                % 73
    18    13.2 0; ...                % 74
    18    12.4 12.65; ...            % 75
    17.6  12.4 12.65; ...            % 76
    17.6  13.2 12.65; ...            % 77
    18    13.2 12.65; ...            % 78
    % column 4 right
    18    16.8 0; ...              % 79
    17.6  16.8 0; ...              % 80
    17.6  17.6 0; ...              % 81
    18    17.6 0; ...              % 82
    18    16.8 12.65; ...          % 83
    17.6  16.8 12.65; ...          % 84
    17.6  17.6 12.65; ...          % 85
    18    17.6 12.65; ...          % 86
    % column 5 right
    18    21.2  0; ...              % 87
    17.6  21.2  0; ...              % 88
    17.6  22    0; ...              % 89
    18    22    0; ...              % 90
    18    21.2  12.65; ...          % 91
    17.6  21.2  12.65; ...          % 92
    17.6  22    12.65; ...          % 93
    18    22    12.65; ...          % 94
    % column
    5.8   36     1.14; ...        95
    5.8   35.6   1.14; ...        96
    6.6   35.6   1.14; ...        97
    6.6   36     1.14; ...        98
    5.8   36     12.65; ...       99
    5.8   35.6   12.65; ...       100
    6.6   35.6   12.65; ...       101
    6.6   36     12.65; ...       102
    % column
    11.4   36     1.14; ...        103
    11.4   35.6   1.14; ...        104
    12.2   35.6   1.14; ...        105
    12.2   36     1.14; ...        106
    11.4   36     12.65; ...       107
    11.4   35.6   12.65; ...       108
    12.2   35.6   12.65; ...       109
    12.2   36     12.65; ...       110
    % column slanted left 1
    0      26     1.14; ...       111
    0.39   25.9   1.14; ...       112
    0.59   26.67  1.14; ...       113
    0.20   26.77  1.14; ...       114
    0      26     12.65; ...      115
    0.39   25.9   12.65; ...      116
    0.59   26.67  12.65; ...      117
    0.20   26.77  12.65; ...      118
    % column slanted left 2
    1.1    30.26  1.14; ...       119
    1.49   30.16  1.14; ...       120
    1.69   30.93  1.14; ...       121
    1.3    31.03  1.14; ...       122
    1.1    30.26  12.65; ...      123
    1.49   30.16  12.65; ...      124
    1.69   30.93  12.65; ...      125
    1.3    31.03  12.65; ...      126
    % column slanted left 3
    2.2    34.52  1.14; ...       127
    2.59   34.42  1.14; ...       128
    2.79   35.19  1.14; ...       129
    2.4    35.29  1.14; ...       130
    2.2    34.52  12.65; ...      131
    2.59   34.42  12.65; ...      132
    2.79   35.19  12.65; ...      133
    2.4    35.29  12.65; ...      134
    % column slanted right 1
    18    26      1.14; ...       135
    17.61 25.9    1.14; ...       136
    17.41 26.67   1.14; ...       137
    17.8  26.77   1.14; ...       138
    18    26      12.65; ...      139
    17.61 25.9    12.65; ...      140
    17.41 26.67   12.65; ...      141
    17.8  26.77   12.65; ...      142
    % column slanted right 2
    16.9  30.26   1.14; ...       143
    16.51 30.16   1.14; ...       144
    16.31 30.93   1.14; ...       145
    16.7  31.03   1.14; ...       146
    16.9  30.26   12.65; ...      147
    16.51 30.16   12.65; ...      148
    16.31 30.93   12.65; ...      149
    16.7  31.03   12.65; ...      150
    % column slanted right 3
    15.8  34.52   1.14; ...       151
    15.41 34.42   1.14; ...       152
    15.21 35.19   1.14; ...       153
    15.6  35.29   1.14; ...       154
    15.8  34.52   12.65; ...      155
    15.41 34.42   12.65; ...      156
    15.21 35.19   12.65; ...      157
    15.6  35.29   12.65; ...      158
    % stairs
    0     23.2    0; ...          159
    18    23.2    0; ...          160
    0     23.2    0.15; ...       161
    18    23.2    0.15; ...       162
    0     22.4    0.15; ...
    18    22.4    0.15; ...
    0     22.4    0.3; ...        165
    18    22.4    0.3; ...
    0     21.6    0.3; ...
    18    21.6    0.3; ...
    0     21.6    0.45; ...
    18    21.6    0.45; ...       170
    0     20.8    0.45; ...
    18    20.8    0.45; ...
    0     20.8    0.6; ...
    18    20.8    0.6; ...
    0     20      0.6; ...        175
    18    20      0.6; ...
    0     20      0.75; ...
    18    20      0.75; ...
    0     19.2    0.75; ...
    18    19.2    0.75; ...       180
    0     19.2    0.9; ...
    18    19.2    0.9; ...
    0     18.4    0.9; ...
    18    18.4    0.9; ...
    0     18.4    1.05; ...       185
    18    18.4    1.05; ...
    0     17.6    1.05; ...
    18    17.6    1.05; ...
    0     17.6    1.2; ...
    18    17.6    1.2; ...         190
    0     16.8    1.2; ...
    18    16.8    1.2; ...
    0     16.8    1.35; ...
    18    16.8    1.35; ...
    0     16      1.35; ...       195
    18    16      1.35; ...
    0     16      1.5; ...
    18    16      1.5; ...
    0     15.2    1.5; ...
    18    15.2    1.5; ...        200
    0     15.2    1.65; ...
    18    15.2    1.65; ...
    0     14.4    1.65; ...
    18    14.4    1.65; ...
    0     14.4    1.8; ...        205
    18    14.4    1.8; ...
    0     13.6    1.8; ...
    18    13.6    1.8; ...
    0     13.6    1.95; ...
    18    13.6    1.95; ...       210
    0     12.8    1.95; ...
    18    12.8    1.95; ...
    0     12.8    2.1; ...
    18    12.8    2.1; ...
    0     12      2.1; ...        215
    18    12      2.1; ...
    0     12      2.25; ...
    18    12      2.25; ...
    0     10.2    2.25; ...
    18    10.2    2.25; ...       220
    0     10.2    2.37; ...
    18    10.2    2.37; ...
    0     10      2.37; ...
    18    10      2.37; ...
    0     10      2.49; ...       225
    18    10      2.49; ...
    0     9.8     2.49; ...
    18    9.8     2.49; ...
    0     9.8     2.61; ...
    18    9.8     2.61; ...       230
    0     9.2     2.61; ...
    18    9.2     2.61; ...
    0     9.2     2.76; ...
    18    9.2     2.76; ...
    0     8.4     2.76; ...       235
    18    8.4     2.76; ...
    0     8.4     2.91; ...
    18    8.4     2.91; ...
    0     7.6     2.91; ...
    18    7.6     2.91; ...       240
    0     7.6     3.06; ...
    18    7.6     3.06; ...
    0     6.8     3.06; ...
    18    6.8     3.06; ...
    0     6.8     3.21; ...       245
    18    6.8     3.21; ...
    0     6       3.21; ...
    18    6       3.21; ...
    0     6       3.36; ...
    18    6       3.36; ...       250
    0     5.2     3.36; ...
    18    5.2     3.36; ...
    0     5.2     3.51; ...
    18    5.2     3.51; ...
    0     4.4     3.51; ...       255
    18    4.4     3.51; ...
    0     4.4     3.66; ...
    18    4.4     3.66; ...
    0     3.6     3.66; ...
    18    3.6     3.66; ...       260
    0     3.6     3.81; ...
    18    3.6     3.81; ...
    0     0     3.81; ...
    18    0     3.81; ...
    % Heng liang lower left 1
    0     17.6    4.28; ...       265
    0     17.6    4.88; ...
    0.6   17.6    4.68; ...
    0     21.2    4.28; ...
    0     21.2    4.88; ...
    0.6   21.2    4.68; ...       270
    % Heng liang lower left 2
    0     22      4.28; ...
    0     22      4.88; ...
    0.6   22      4.68; ...
    0     26      4.28; ...
    0     26      4.88; ...       275
    0.6   26      4.68; ...
    % Heng liang lower right 1
    18    17.6    4.28; ...
    18    17.6    4.88; ...
    17.4  17.6    4.68; ...
    18    21.2    4.28; ...       280
    18    21.2    4.88; ...
    17.4  21.2    4.68; ...
    % Heng liang lower right 2
    18    22      4.28; ...
    18    22      4.88; ...
    17.4  22      4.68; ...       285
    18    26      4.28; ...
    18    26      4.88; ...
    17.4  26      4.68; ...
    % Hengliang slanted left 1
    0.2   26.77   4.28; ...
    0.2   26.77   4.88; ...       290
    0.78  26.62   4.68; ...
    1.1   30.25   4.28; ...
    1.1   30.25   4.88; ...
    1.68  30.1    4.68; ...
    % Hengliang slanted left 2
    1.3   31      4.28; ...       295
    1.3   31      4.88; ...
    1.88  30.88   4.68; ...
    2.2   34.51   4.28; ...
    2.2   34.51   4.88; ...
    2.78  34.36   4.68; ...       300
    % Hengliang slanted right 1
    17.8  26.77   4.28; ...
    17.8  26.77   4.88; ...
    17.22 26.62   4.68; ...
    16.9   30.25   4.28; ...
    16.9   30.25   4.88; ...      305
    16.32  30.1    4.68; ...
    % Hengliang slanted right 2
    16.7   31      4.28; ...
    16.7   31      4.88; ...
    16.12  30.88   4.68; ...
    15.8   34.51   4.28; ...      310
    15.8   34.51   4.88; ...
    15.22  34.36   4.68; ...
    % Hengliang top 1
    2.6    36      4.28; ...
    2.6    36      4.88; ...
    2.6    35.4    4.68; ...      315
    5.8    36      4.28; ...
    5.8    36      4.88; ...
    5.8    35.4    4.68; ...
    % Hengliang top 2
    6.6    36      4.28; ...
    6.6    36      4.88; ...      320
    6.6    35.4    4.68; ...
    11.4   36      4.28; ...
    11.4   36      4.88; ...
    11.4   35.4    4.68; ...
    % Hengliang top 3
    12.2   36      4.28; ...      325
    12.2   36      4.88; ...
    12.2   35.4    4.68; ...
    15.4   36      4.28; ...
    15.4   36      4.88; ...
    15.4   35.4    4.68; ...      330
    % Heng liang higher left 1
    0     8.8     6.35; ...
    0     8.8     6.95; ...
    0.7   8.8     6.75; ...
    0     12.4    6.35; ...
    0     12.4    6.95; ...       335
    0.7   12.4    6.75; ...
    % Heng liang higher left 2
    0     13.2    6.35; ...
    0     13.2    6.95; ...
    0.7   13.2    6.75; ...
    0     16.8    6.35; ...       340
    0     16.8    6.95; ...
    0.7   16.8    6.75; ...
    % Heng liang higher left 3
    0     17.6    6.35; ...
    0     17.6    6.95; ...
    0.7   17.6    6.75; ...       345
    0     21.2    6.35; ...
    0     21.2    6.95; ...
    0.7   21.2    6.75; ...
    % Heng liang higher left 4
    0     22      6.35; ...
    0     22      6.95; ...       350
    0.7   22      6.75; ...
    0     26      6.35; ...
    0     26      6.95; ...
    0.7   26      6.75; ...
    % Heng liang higher right 1
    18    8.8     6.35; ...       355
    18    8.8     6.95; ...
    17.3  8.8     6.75; ...
    18    12.4    6.35; ...
    18    12.4    6.95; ...
    17.3  12.4    6.75; ...       360
    % Heng liang higher right 2
    18    13.2    6.35; ...
    18    13.2    6.95; ...
    17.3  13.2    6.75; ...
    18    16.8    6.35; ...
    18    16.8    6.95; ...       365
    17.3  16.8    6.75; ...
    % Heng liang higher right 3
    18    17.6    6.35; ...
    18    17.6    6.95; ...
    17.3  17.6    6.75; ...
    18    21.2    6.35; ...       370
    18    21.2    6.95; ...
    17.3  21.2    6.75; ...
    % Heng liang higher right 4
    18    22      6.35; ...
    18    22      6.95; ...
    17.3  22      6.75; ...       375
    18    26      6.35; ...
    18    26      6.95; ...
    17.3  26      6.75; ...
    % Hengliang slanted left 1
    0.2   26.77   6.35; ...
    0.2   26.77   6.95; ...       380
    0.78  26.62   6.75; ...
    1.1   30.25   6.35; ...
    1.1   30.25   6.95; ...
    1.68  30.1    6.75; ...
    % Hengliang slanted left 2
    1.3   31      6.35; ...       385
    1.3   31      6.95; ...
    1.88  30.88   6.75; ...
    2.2   34.51   6.35; ...
    2.2   34.51   6.95; ...
    2.78  34.36   6.75; ...       390
    % Hengliang slanted right 1
    17.8  26.77   6.35; ...
    17.8  26.77   6.95; ...
    17.22 26.62   6.75; ...
    16.9   30.25   6.35; ...
    16.9   30.25   6.95; ...      395
    16.32  30.1    6.75; ...
    % Hengliang slanted right 2
    16.7   31      6.35; ...
    16.7   31      6.95; ...
    16.12  30.88   6.75; ...
    15.8   34.51   6.35; ...     400
    15.8   34.51   6.95; ...
    15.22  34.36   6.75; ...
    % Hengliang top 1
    2.6    36      6.35; ...
    2.6    36      6.95; ...
    2.6    35.4    6.75; ...      405
    5.8    36      6.35; ...
    5.8    36      6.95; ...
    5.8    35.4    6.75; ...
    % Hengliang top 2
    6.6    36      6.35; ...
    6.6    36      6.95; ...      410
    6.6    35.4    6.75; ...
    11.4   36      6.35; ...
    11.4   36      6.95; ...
    11.4   35.4    6.75; ...
    % Hengliang top 3
    12.2   36      6.35; ...      415
    12.2   36      6.95; ...
    12.2   35.4    6.75; ...
    15.4   36      6.35; ...
    15.4   36      6.95; ...
    15.4   35.4    6.75; ...     420
    % little Hengliang left 1
    0      0       6.95; ...
    0.4    0       6.95; ...
    0.4    0       6.75; ...
    0      0       6.75; ...
    0      3.6     6.95; ...      425
    0.4    3.6     6.95; ...
    0.4    3.6     6.75; ...
    0      3.6     6.75; ...
    % little Hengliang left 2
    0      4.4     6.95; ...
    0.4    4.4     6.95; ...      430
    0.4    4.4     6.75; ...
    0      4.4     6.75; ...
    0      8       6.95; ...
    0.4    8       6.95; ...
    0.4    8       6.75; ...      435
    0      8       6.75; ...
    % little Hengliang left 3
    0      8.8     4.88; ...
    0.4    8.8     4.88; ...
    0.4    8.8     4.68; ...
    0      8.8     4.68; ...      440
    0      12.4    4.88; ...
    0.4    12.4    4.88; ...
    0.4    12.4    4.68; ...
    0      12.4    4.68; ...
    % little Hengliang left 4
    0      13.2    4.88; ...      445
    0.4    13.2    4.88; ...
    0.4    13.2    4.68; ...
    0      13.2    4.68; ...
    0      16.8    4.88; ...
    0.4    16.8    4.88; ...      450
    0.4    16.8    4.68; ...
    0      16.8    4.68; ...
    % little Hengliang right 1
    18     0       6.95; ...
    17.6   0       6.95; ...
    17.6   0       6.75; ...      455
    18     0       6.75; ...
    18     3.6     6.95; ...
    17.6   3.6     6.95; ...
    17.6   3.6     6.75; ...
    18     3.6     6.75; ...      460
    % little Hengliang right 2
    18     4.4     6.95; ...
    17.6   4.4     6.95; ...
    17.6   4.4     6.75; ...
    18     4.4     6.75; ...
    18     8       6.95; ...      465
    17.6   8       6.95; ...
    17.6   8       6.75; ...
    18     8       6.75; ...
    % little Hengliang right 3
    18     8.8     4.88; ...
    17.6   8.8     4.88; ...      470
    17.6   8.8     4.68; ...
    18     8.8     4.68; ...
    18     12.4    4.88; ...
    17.6   12.4    4.88; ...
    17.6   12.4    4.68; ...      475
    18     12.4    4.68; ...
    % little Hengliang right 4
    18     13.2    4.88; ...
    17.6   13.2    4.88; ...
    17.6   13.2    4.68; ...
    18     13.2    4.68; ...      480
    18     16.8    4.88; ...
    17.6   16.8    4.88; ...
    17.6   16.8    4.68; ...
    18     16.8    4.68; ...
    ];

wnum = size(wall,1); % calculate the total wall number

